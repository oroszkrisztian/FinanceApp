{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { serve } from \"@hono/node-server\";\nimport { Hono } from \"hono\";\nimport { cors } from \"hono/cors\";\nimport { logger } from \"hono/logger\";\n\nimport accounts from \"./routes/accounts\";\nimport transaction from \"./routes/transaction\";\nimport categories from \"./routes/categories\";\nimport budget from \"./routes/budget\";\nimport payments from \"./routes/payment\";\nimport users from \"./routes/user\";\nimport auth from \"./routes/auth\";\nimport ai from \"./routes/ai\";\n\nimport \"dotenv/config\";\n\nconst app = new Hono();\nconst port = parseInt(process.env.PORT || \"3000\");\n\napp.use(\n  \"*\",\n  cors({\n    origin: [\n      \"http://localhost:5173\",\n      \"http://127.0.0.1:5173\",\n      \"https://finance-app-frontend-bice.vercel.app\",\n      \"https://finance-app-frontend-ebyddx0p1-oroszkrisztians-projects.vercel.app\",\n      \"https://backendfinanceapp.krisztianorosz0.workers.dev\"\n    ],\n    allowMethods: [\"POST\", \"GET\", \"DELETE\", \"PUT\", \"OPTIONS\"],\n    allowHeaders: [\"Content-Type\", \"Authorization\"],\n    credentials: true,\n  })\n);\n\napp.use(\"*\", logger());\n\napp.route(\"/auth\", auth);\napp.route(\"/accounts\", accounts);\napp.route(\"/transaction\", transaction);\napp.route(\"/categories\", categories);\napp.route(\"/budget\", budget);\napp.route(\"/payment\", payments);\napp.route(\"/user\", users);\napp.route(\"/ai\", ai); \n\napp.get(\"/test-gemini\", async (c) => {\n  try {\n    if (!process.env.GEMINI_API_KEY) {\n      return c.json({\n        success: false,\n        error: \"GEMINI_API_KEY not configured\",\n      }, 500);\n    }\n\n    const { GoogleGenerativeAI } = await import(\"@google/generative-ai\");\n    const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\n    const model = genAI.getGenerativeModel({ model: \"gemini-pro\" });\n    \n    const result = await model.generateContent(\"Say hello and confirm you're working correctly for financial analysis.\");\n    const response = await result.response;\n    const text = response.text();\n\n    return c.json({\n      success: true,\n      message: \"Gemini API connection successful\",\n      response: text,\n      config: {\n        apiKeyProvided: !!process.env.GEMINI_API_KEY,\n        keyPrefix: process.env.GEMINI_API_KEY ? process.env.GEMINI_API_KEY.substring(0, 10) + \"...\" : \"MISSING\",\n      },\n    });\n  } catch (error) {\n    console.error(\"‚ùå Gemini test failed:\", error);\n    return c.json({\n      success: false,\n      error: \"Gemini API test failed\",\n      details: error instanceof Error ? error.message : \"Unknown error\",\n    }, 500);\n  }\n});\n\nconst retryWithBackoff = async <T>(fn: () => Promise<T>, maxRetries = 3, baseDelay = 1000): Promise<T> => {\n  let lastError: unknown;\n  \n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\n    try {\n      console.log(`üìß Daily notification attempt ${attempt}/${maxRetries}`);\n      return await fn();\n    } catch (error: unknown) {\n      lastError = error;\n      \n      const errorMessage = error instanceof Error ? error.message : String(error);\n      const errorCode = error && typeof error === 'object' && 'code' in error ? error.code : undefined;\n      \n      const isRetryableError = \n        errorMessage.includes('timeout') ||\n        errorMessage.includes('ECONNRESET') ||\n        errorMessage.includes('ENOTFOUND') ||\n        errorMessage.includes('cold start') ||\n        errorCode === 'ECONNREFUSED' ||\n        errorCode === 'ETIMEDOUT';\n\n      if (attempt === maxRetries || !isRetryableError) {\n        console.error(`‚ùå Attempt ${attempt} failed (final):`, errorMessage);\n        throw lastError;\n      }\n\n      const delay = baseDelay * Math.pow(2, attempt - 1); \n      console.warn(`‚ö†Ô∏è Attempt ${attempt} failed, retrying in ${delay}ms:`, errorMessage);\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n  \n  throw lastError;\n};\napp.post(\"/cron/daily-notifications\", async (c) => {\n  const startTime = Date.now();\n  \n  try {\n    console.log(\"üìß Daily notification endpoint triggered\");\n\n    const result = await retryWithBackoff(async () => {\n      const { default: ExpenseNotificationService } = await import(\"./services/expenseNotificationService\");\n      const notificationService = new ExpenseNotificationService(\n        process.env.BREVO_API_KEY!,\n        process.env.BREVO_SENDER_EMAIL || \"noreply@yourfinanceapp.com\",\n        process.env.BREVO_SENDER_NAME || \"Your Finance App\"\n      );\n\n      return await notificationService.sendDailyScheduledNotifications();\n    }, 3, 2000); \n\n    const duration = Date.now() - startTime;\n    console.log(`‚úÖ Daily notifications completed in ${duration}ms:`, result);\n\n    return c.json({\n      success: true,\n      message: \"Daily notifications sent successfully\",\n      result,\n      duration: `${duration}ms`,\n      timestamp: new Date().toISOString(),\n    });\n  } catch (error) {\n    const duration = Date.now() - startTime;\n    console.error(`‚ùå Daily notification endpoint failed after ${duration}ms:`, error);\n    \n    return c.json({\n      success: false,\n      error: \"Failed to send daily notifications after retries\",\n      details: error instanceof Error ? error.message : \"Unknown error\",\n      duration: `${duration}ms`,\n      timestamp: new Date().toISOString(),\n    }, 500);\n  }\n});\n\n\napp.get(\"/test-brevo\", async (c) => {\n  try {\n    const { default: BrevoEmailService } = await import(\n      \"./services/brevoService\"\n    );\n    const brevoService = new BrevoEmailService(process.env.BREVO_API_KEY!);\n\n    const isConnected = await brevoService.testConnection();\n\n    return c.json({\n      brevoConnected: isConnected,\n      config: {\n        apiKeyProvided: !!process.env.BREVO_API_KEY,\n        senderEmail: process.env.BREVO_SENDER_EMAIL,\n        senderName: process.env.BREVO_SENDER_NAME,\n      },\n    });\n  } catch (error) {\n    console.error(\"‚ùå Brevo test failed:\", error);\n    return c.json(\n      {\n        error: \"Brevo test failed\",\n        details: error instanceof Error ? error.message : \"Unknown error\",\n      },\n      500\n    );\n  }\n});\n\napp.get(\"/exchange-rates\", async (c) => {\n  try {\n    const response = await fetch(\"https://www.bnr.ro/nbrfxrates.xml\");\n    if (!response.ok) {\n      throw new Error(`Failed to fetch exchange rates: ${response.statusText}`);\n    }\n    const xmlText = await response.text();\n    return c.text(xmlText, 200, {\n      \"Content-Type\": \"application/xml\",\n    });\n  } catch (error) {\n    console.error(\"Proxy error:\", error);\n    return c.json({ error: \"Failed to fetch exchange rates\" }, 500);\n  }\n});\n\napp.get(\"/\", (c) => c.text(\"Server is running\"));\n\nconsole.log(`Server is running on port ${port}`);\n\nif (process.env.GEMINI_API_KEY) {\n  console.log(\"‚úÖ Gemini API key configured\");\n} else {\n  console.log(\"‚ö†Ô∏è  Gemini API key not found in environment variables\");\n}\n\nserve({\n  fetch: app.fetch,\n  port,\n});\n\nconst gracefulShutdown = () => {\n  console.log(\"\\nüõë Shutting down server...\");\n  process.exit(0);\n};\n\n\n\nprocess.on(\"SIGINT\", gracefulShutdown);\nprocess.on(\"SIGTERM\", gracefulShutdown);\nprocess.on(\"SIGQUIT\", gracefulShutdown);\n\nprocess.on(\"uncaughtException\", (error) => {\n  console.error(\"Uncaught Exception:\", error);\n  gracefulShutdown();\n});\n\nprocess.on(\"unhandledRejection\", (reason, promise) => {\n  console.error(\"Unhandled Rejection at:\", promise, \"reason:\", reason);\n  gracefulShutdown();\n});"]}